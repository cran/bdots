<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>User Curve Functions</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">User Curve Functions</h1>



<p>We saw in the <a href="bdots.html">general overview</a> when first generating our model fits with <code>bdotsFit</code> that we we could specify the curve with the argument <code>curveType</code>. Presently, the <code>bdots</code> package contains three options for this: <code>doubleGauss</code>, <code>logistic</code>, and <code>polynomial</code>. Documentation is included for each of these curves.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bdots)

fit &lt;-<span class="st"> </span><span class="kw">bdotsFit</span>(<span class="dt">data =</span> cohort_unrelated,
                <span class="dt">subject =</span> <span class="st">&quot;Subject&quot;</span>,
                <span class="dt">time =</span> <span class="st">&quot;Time&quot;</span>,
                <span class="dt">y =</span> <span class="st">&quot;Fixations&quot;</span>,
                <span class="dt">group =</span> <span class="kw">c</span>(<span class="st">&quot;DB_cond&quot;</span>, <span class="st">&quot;LookType&quot;</span>),
                <span class="dt">curveType =</span> <span class="kw">doubleGauss</span>(<span class="dt">concave =</span> <span class="ot">TRUE</span>),
                <span class="dt">cores =</span> <span class="dv">2</span>)</code></pre></div>
<p>Note that each of these is a function in their own right and must be passed in as a <code>call</code> object. Curve functions that include arguments further specifying the type of curve, i.e., <code>doubleGauss(concave = TRUE)</code> and <code>polynomial(degree = n)</code>, should include these when the call is passed into <code>bdotsFit</code> as seen in the example above.</p>
<p>Because each of the functions exists independently of <code>bdotsFit</code>, users can specify their own curve functions for the fitting and bootstrapping process. The purpose of this vignette is to demonstrate how to do so. If you find that you have a curve function that is especially useful, please create a request to have it added to the <code>bdots</code> package <a href="https://github.com/collinn/bdots/issues">here</a>.</p>
<p>We will examine the <code>doubleGauss</code> function in more detail to see how we might go about creating our own. First, let's identify the components of this function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">doubleGauss
<span class="co">#&gt; function (dat, y, time, params = NULL, concave = TRUE, ...) </span>
<span class="co">#&gt; {</span>
<span class="co">#&gt;     if (is.null(params)) {</span>
<span class="co">#&gt;         params &lt;- dgaussPars(dat, y, time, concave)</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     else {</span>
<span class="co">#&gt;         if (length(params) != 6) </span>
<span class="co">#&gt;             stop(&quot;doubleGauss requires 6 parameters be specified for refitting&quot;)</span>
<span class="co">#&gt;         if (!all(names(params) %in% c(&quot;mu&quot;, &quot;ht&quot;, &quot;sig1&quot;, &quot;sig2&quot;, </span>
<span class="co">#&gt;             &quot;base1&quot;, &quot;base2&quot;))) {</span>
<span class="co">#&gt;             stop(&quot;doubleGauss parameters for refitting must be correctly labeled&quot;)</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     if (is.null(params)) {</span>
<span class="co">#&gt;         return(NULL)</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     y &lt;- str2lang(y)</span>
<span class="co">#&gt;     time &lt;- str2lang(time)</span>
<span class="co">#&gt;     ff &lt;- bquote(.(y) ~ (.(time) &lt; mu) * (exp(-1 * (.(time) - </span>
<span class="co">#&gt;         mu)^2/(2 * sig1^2)) * (ht - base1) + base1) + (mu &lt;= </span>
<span class="co">#&gt;         .(time)) * (exp(-1 * (.(time) - mu)^2/(2 * sig2^2)) * </span>
<span class="co">#&gt;         (ht - base2) + base2))</span>
<span class="co">#&gt;     attr(ff, &quot;parnames&quot;) &lt;- names(params)</span>
<span class="co">#&gt;     return(list(formula = ff, params = params))</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;bytecode: 0x55b748e91a38&gt;</span>
<span class="co">#&gt; &lt;environment: namespace:bdots&gt;</span></code></pre></div>
<p>There are four things to note:</p>
<ol style="list-style-type: decimal">
<li><dl>
<dt>Arguments</dt>
<dd>In addition to the argument <code>concave = TRUE</code>, which specifies the curve, we also have <code>dat</code>, <code>y</code>, <code>time</code>, <code>params = NULL</code>, and <code>...</code>. These are the names that must be used for the function to be called correctly. The first represents a <code>data.frame</code> or <code>data.table</code> subset from the <code>data</code> argument to <code>bdotsFit</code>, while <code>y</code> and <code>time</code> correspond to their respective arguments in <code>bdotsFit</code> and should assume that the arguments are passed in as <code>character</code>. It's important to remember to set <code>params = NULL</code>, as this is only used during the refitting step.
</dd>
</dl></li>
<li><dl>
<dt>Body</dt>
<dd>As can be seen here, when <code>params = NULL</code>, the body of the function computes the necessary starting parameters to be used with the <code>gnls</code> fitting function. In this case, the function <code>dgaussPars</code> handles the initial parameter estimation and returns a named <code>numeric</code>. When <code>params</code> is not <code>NULL</code>, it's usually a good idea to verify that it is the correct length and has the correct parameter names.
</dd>
</dl></li>
<li><dl>
<dt>Formula</dt>
<dd>Care must be exercised when creating the <code>formula</code> object, as it must be quoted. One may use <code>bquote</code> and <code>str2lang</code> to substitute in the <code>character</code> values for <code>y</code> and <code>time</code>. Alternatively, if this is to only be used for a particular data set, one can simply use <code>quote</code> with the appropriate values used for <code>y</code> and <code>time</code>, as we will demonstrate below. Finally, the quoted <code>formula</code> should contain a single attribute <code>parnames</code> which has the names of the parameters used.
</dd>
</dl></li>
<li><dl>
<dt>Return Value</dt>
<dd>All of the curve functions should return a named list with two elements: a quoted <code>formula</code> and <code>params</code>, a named <code>numeric</code> with the parameters.
</dd>
</dl></li>
</ol>
<p>Briefly, we can see how this function is used by subsetting the data to a single subject and calling it directly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Return a unique subject/group permutation
dat &lt;-<span class="st"> </span>cohort_unrelated[Subject <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>DB_cond <span class="op">==</span><span class="st"> </span><span class="dv">50</span> <span class="op">&amp;</span><span class="st"> </span>LookType <span class="op">==</span><span class="st"> &quot;Cohort&quot;</span>, ]
dat
<span class="co">#&gt;      Subject Time DB_cond  Fixations LookType Group</span>
<span class="co">#&gt;   1:       1    0      50 0.01136364   Cohort    50</span>
<span class="co">#&gt;   2:       1    4      50 0.01136364   Cohort    50</span>
<span class="co">#&gt;   3:       1    8      50 0.01136364   Cohort    50</span>
<span class="co">#&gt;   4:       1   12      50 0.01136364   Cohort    50</span>
<span class="co">#&gt;   5:       1   16      50 0.02272727   Cohort    50</span>
<span class="co">#&gt;  ---                                               </span>
<span class="co">#&gt; 497:       1 1984      50 0.02272727   Cohort    50</span>
<span class="co">#&gt; 498:       1 1988      50 0.02272727   Cohort    50</span>
<span class="co">#&gt; 499:       1 1992      50 0.02272727   Cohort    50</span>
<span class="co">#&gt; 500:       1 1996      50 0.02272727   Cohort    50</span>
<span class="co">#&gt; 501:       1 2000      50 0.02272727   Cohort    50</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## See return value
<span class="kw">doubleGauss</span>(<span class="dt">dat =</span> dat, <span class="dt">y =</span> <span class="st">&quot;Fixations&quot;</span>, <span class="dt">time =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">concave =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Fixations ~ (Time &lt; mu) * (exp(-1 * (Time - mu)^2/(2 * sig1^2)) * </span>
<span class="co">#&gt;     (ht - base1) + base1) + (mu &lt;= Time) * (exp(-1 * (Time - </span>
<span class="co">#&gt;     mu)^2/(2 * sig2^2)) * (ht - base2) + base2)</span>
<span class="co">#&gt; attr(,&quot;parnames&quot;)</span>
<span class="co">#&gt; [1] &quot;mu&quot;    &quot;ht&quot;    &quot;sig1&quot;  &quot;sig2&quot;  &quot;base1&quot; &quot;base2&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $params</span>
<span class="co">#&gt;           mu           ht         sig1         sig2        base1        base2 </span>
<span class="co">#&gt; 428.00000000   0.21590909 152.00000000 396.00000000   0.01136364   0.02272727</span></code></pre></div>
<p>We will now create an entirely new function that is not included in <code>bdots</code> to demonstrate that it works the same; the only change we will make is to substitute in the values for <code>y</code> and <code>time</code> without using <code>str2lang</code>. For our data set here, the corresponding values to <code>y</code> and <code>time</code> are <code>&quot;Fixations&quot;</code> and <code>&quot;Time&quot;</code>, respectively</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">doubleGauss2 &lt;-<span class="st"> </span><span class="cf">function</span> (dat, y, time, <span class="dt">params =</span> <span class="ot">NULL</span>, <span class="dt">concave =</span> <span class="ot">TRUE</span>, ...) {
  
  <span class="cf">if</span> (<span class="kw">is.null</span>(params)) {
    ## Instead of defining our own, just reuse the one in bdots
    params &lt;-<span class="st"> </span>bdots<span class="op">:::</span><span class="kw">dgaussPars</span>(dat, y, time, concave)
  }
  <span class="cf">else</span> {
    <span class="cf">if</span> (<span class="kw">length</span>(params) <span class="op">!=</span><span class="st"> </span><span class="dv">6</span>) 
      <span class="kw">stop</span>(<span class="st">&quot;doubleGauss requires 6 parameters be specified for refitting&quot;</span>)
    <span class="cf">if</span> (<span class="op">!</span><span class="kw">all</span>(<span class="kw">names</span>(params) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;ht&quot;</span>, <span class="st">&quot;sig1&quot;</span>, <span class="st">&quot;sig2&quot;</span>, 
                                  <span class="st">&quot;base1&quot;</span>, <span class="st">&quot;base2&quot;</span>))) {
      <span class="kw">stop</span>(<span class="st">&quot;doubleGauss parameters for refitting must be correctly labeled&quot;</span>)
    }
  }

    ## Here, we use Fixations and Time directly
    ff &lt;-<span class="st"> </span><span class="kw">bquote</span>(Fixations <span class="op">~</span><span class="st"> </span>(Time <span class="op">&lt;</span><span class="st"> </span>mu) <span class="op">*</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(Time <span class="op">-</span><span class="st"> </span>mu)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>
<span class="st">                  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sig1<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(ht <span class="op">-</span><span class="st"> </span>base1) <span class="op">+</span><span class="st"> </span>base1) <span class="op">+</span><span class="st"> </span>(mu <span class="op">&lt;=</span><span class="st"> </span>Time) <span class="op">*</span><span class="st"> </span>
<span class="st">                  </span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(Time <span class="op">-</span><span class="st"> </span>mu)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sig2<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(ht <span class="op">-</span><span class="st"> </span>base2) <span class="op">+</span><span class="st"> </span>base2))
    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">formula =</span> ff, <span class="dt">params =</span> params))
}

same_fit_different_day &lt;-<span class="st"> </span><span class="kw">bdotsFit</span>(<span class="dt">data =</span> cohort_unrelated,
                                   <span class="dt">subject =</span> <span class="st">&quot;Subject&quot;</span>,
                                   <span class="dt">time =</span> <span class="st">&quot;Time&quot;</span>,
                                   <span class="dt">y =</span> <span class="st">&quot;Fixations&quot;</span>,
                                   <span class="dt">group =</span> <span class="kw">c</span>(<span class="st">&quot;DB_cond&quot;</span>, <span class="st">&quot;LookType&quot;</span>),
                                   <span class="dt">curveType =</span> <span class="kw">doubleGauss2</span>(<span class="dt">concave =</span> <span class="ot">TRUE</span>),
                                   <span class="dt">cores =</span> <span class="dv">2</span>)</code></pre></div>
<p>Seeds have not yet been implemented, so there is some possibility that the resulting parameters are slightly different; however, using the <code>coef</code> function, we can roughly confirm their equivalence</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Original fit
<span class="kw">head</span>(<span class="kw">coef</span>(fit))
<span class="co">#&gt;            mu        ht     sig1     sig2        base1      base2</span>
<span class="co">#&gt; [1,] 429.7595 0.1985978 159.8869 314.6389  0.009709772 0.03376106</span>
<span class="co">#&gt; [2,] 634.9292 0.2635044 303.8081 215.3845 -0.020636092 0.02892360</span>
<span class="co">#&gt; [3,] 647.0655 0.2543769 518.9632 255.9871 -0.213087597 0.01368195</span>
<span class="co">#&gt; [4,] 723.0551 0.2582110 392.9509 252.9381 -0.054827082 0.03197292</span>
<span class="co">#&gt; [5,] 501.4843 0.2247729 500.8605 158.4164 -0.331698893 0.02522686</span>
<span class="co">#&gt; [6,] 460.7152 0.3067659 382.7323 166.0833 -0.243308940 0.03992168</span>

## &quot;New&quot; fit
<span class="kw">head</span>(<span class="kw">coef</span>(same_fit_different_day))
<span class="co">#&gt;            mu        ht     sig1     sig2       base1      base2</span>
<span class="co">#&gt; [1,] 424.0311 0.1985000 154.2040 319.4740  0.01136408 0.03363656</span>
<span class="co">#&gt; [2,] 634.8093 0.2635148 303.6648 215.4307 -0.02058587 0.02893339</span>
<span class="co">#&gt; [3,] 646.9448 0.2544417 517.6521 255.9967 -0.21165093 0.01357057</span>
<span class="co">#&gt; [4,] 723.0861 0.2582117 393.0037 252.9037 -0.05485216 0.03197492</span>
<span class="co">#&gt; [5,] 501.6132 0.2247893 500.9494 158.3115 -0.33217172 0.02522935</span>
<span class="co">#&gt; [6,] 460.7371 0.3067971 382.5232 165.9932 -0.24285941 0.03993349</span></code></pre></div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
